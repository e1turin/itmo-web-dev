{
  "id": "user-api",
  "description": "Схема состояний пользователя",
  "initial": "initial",
  "states": {
    "initial": {
      "on": {
        "POST /api/auth/tokens/validate": [
          {
            "target": "authtorized",
            "cond": "valid token"
          },
          {
            "target": "unauthtorized",
            "cond": "invalid token"
          }
        ]
      }
    },
    "new": {
      "always": [
        {
          "target": "authtorized",
          "cond": "has tocken"
        },
        {
          "target": "unauthtorized",
          "cond": "no token"
        }
      ]
    },
    "authtorized": {
      "always": [
        {
          "target": "unauthtorized",
          "cond": "token expires"
        },
        {
          "target": "[MAIN PAGE]",
          "cond": "GET /main"
        }
      ]
    },
    "unauthtorized": {
      "always": {
        "target": "[LOGIN PAGE]",
        "cond": "GET /login"
      },
      "on": {
        "PUT /api/users/create": [
          {
            "target": "new",
            "cond": "new email"
          },
          {
            "target": "unauthtorized",
            "cond": "used email",
            "internal": false
          }
        ],
        "POST /api/auth/tokens/create": {
          "target": "authtorized"
        }
      }
    },
    "[MAIN PAGE]": {
      "always": {
        "target": "unauthtorized",
        "cond": "DELETE /api/auth/delete"
      },
      "on": {
        "POST /points/append": {
          "target": "[MAIN PAGE]",
          "internal": false
        },
        "DELETE /points/truncate": {},
        "GET /points/?page": {}
      }
    },
    "[LOGIN PAGE]": {
      "always": {
        "target": "authtorized",
        "cond": "POST /api/auth/tokens/create"
      }
    }
  }
}
